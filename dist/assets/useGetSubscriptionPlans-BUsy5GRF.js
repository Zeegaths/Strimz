import{r as n,a as w,g as B,b as U,f as y,i as r,w as u,W as D}from"./index-5lFW-7Db.js";const E=()=>{const[k,S]=n.useState([]),[h,g]=n.useState(0),[m,b]=n.useState(0),[A,v]=n.useState(0),[L,P]=n.useState(0),{pathname:C}=w(),e=n.useCallback(async()=>{try{const c=(await B(U).getAllSubscriptionPlans()).map((a,s)=>({id:s,name:a[0],fee:y(a[1],18),isActive:a[2]}));S(c)}catch(t){console.error(t)}},[]),d=n.useCallback(()=>{g(t=>t+1),e()},[e]),l=n.useCallback(()=>{b(t=>t+1),e()},[e]),f=n.useCallback(()=>{v(t=>t+1),e()},[e]),p=n.useCallback(()=>{P(t=>t+1),e()},[e]);return(C==="/user/createsubscription"||C==="/admin/updatesubscriptionplan")&&setTimeout(()=>{e()},8e3),n.useEffect(()=>{e();const t={address:void 0,topics:[r("SubscriptionPlanCreated(address,uint256,string)")]};u.getLogs({...t,fromBlock:7787519}).then(o=>{g(o.length+1)});const i={address:void 0,topics:[r("SubscriptionPlanUpdated(address,uint256,string)")]};u.getLogs({...i,fromBlock:7787519}).then(o=>{b(o.length+1)});const c={address:void 0,topics:[r("SubscriptionPlanActivated(uint256)")]};u.getLogs({...c,fromBlock:7787519}).then(o=>{v(o.length+1)});const a={address:void 0,topics:[r("SubscriptionPlanDeactivated(uint256)")]};u.getLogs({...a,fromBlock:7787519}).then(o=>{P(o.length+1)});const s=new D(void 0);return s.on(t,d),s.on(i,l),s.on(c,f),s.on(a,p),()=>{s.off(t,d),s.off(i,l),s.off(c,f),s.off(a,p)}},[e,d,h,l,m,f,A,p,L]),k};export{E as u};
